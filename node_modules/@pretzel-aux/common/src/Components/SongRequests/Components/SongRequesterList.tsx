import * as React from 'react';
import { Box, Image, Text } from 'grommet';
import { Requester, SongRequest } from '../../../Core/Player/Queries/schema';
import { Night } from '../../../Styled';
import { getCheerForValue } from '../../../Core/Twitch/Cheers';

interface PublicProps {
  request: SongRequest;
}

type Props = PublicProps;

export function getSongRequesterListHeight(request: SongRequest): string {
  const topPadding = 4;
  const titleHeight = 16;
  const listHeight = 21 * request.requesters.length;
  return `${topPadding + titleHeight + listHeight}px`;
}

export class SongRequesterList extends React.Component<Props> {
  state = {};

  public render() {
    return (
      <Box>
        <Text size="12px" color={Night.textMuted}>
          REQUESTED BY
        </Text>
        <Box>{this.props.request.requesters.map(requester => this.renderRequester(requester))}</Box>
      </Box>
    );
  }

  private renderRequester(requester: Requester) {
    const cheer = getCheerForValue(requester.bitTotal);
    return (
      <Box direction="row" justify="between" key={requester.displayName}>
        <Text size="small" color={Night.textTitles}>
          {requester.displayName}
        </Text>
        <Text size="small" color={cheer.color}>
          {requester.bitTotal} <Image src={cheer.static} width={16} height={16} />
        </Text>
      </Box>
    );
  }
}
